<script type="text/javascript">
  $( document ).ready(function() {
  $('#geobutton').on('click', function () {
    geoFindMe();
  })
  });

function geoFindMe() {

  if (!navigator.geolocation){
    alert("Sorry, finding your location is not supported by your browser");
    $('#geobutton').attr("disabled", true)
    return;
  }

  function success(position) {
    var latitude  = position.coords.latitude;
    var longitude = position.coords.longitude;
    var text = longitude + ',' + latitude;
    $("#near").val(text)
  }

  function error() {
    alert("Sorry, we are unable to get your location");
  }

  $("#near").val("Locatingâ€¦")

  navigator.geolocation.getCurrentPosition(success, error);
}
</script>
<div id="out"></div>
<%= form_tag("/courses", method: "get", class: 'form-horizontal ', role: 'form') do %>
  <div class="form-group ">
    <%= label_tag(:q, "Find", class:"col-sm-1 control-label") %>
    <div class="col-sm-11">
      <%= text_field_tag(:q, params[:q], class:"form-control", placeholder: "Courses, Subjects, Topics") %>
    </div>
  </div>

  <div class="form-group ">
    <%= label_tag(:near, "Near", class:"col-sm-1 control-label") %>
    <div class="col-sm-5">
      <%= text_field_tag(:near, params[:near], class:"form-control near-field", placeholder: "Postcode, Place, Address") %>
      <%= hidden_field_tag(:sort, params[:sort]) %>   
    </div>
    
    <div class="col-sm-3">
      <span class="location-hint">Use current location</span>
      <button id="geobutton" class="geobutton btn btn-default" type="button" title="Use current location"> <%= image_tag 'location.png', width: 25, height: 25 %></button>
    </div>

</div>

  <div class="form-group ">
    <div class="col-sm-8 col-sm-offset-1">
        <div class="">
        <button class="btn btn-primary " type="submit" title="Search"><i class="glyphicon glyphicon-search"></i> Search</button>
        <span class="show-all"> &nbsp; <%= link_to 'Show All Courses', courses_url %></span>
        </div>
       
        </div>  
 </div>

<% end %>



